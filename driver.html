<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ShareRide ‚Äî Meerut</title>
  <link rel="icon" href="https://i.pinimg.com/originals/bb/49/5b/bb495ba3db3be888b6a8b1e8f1ad7e2d.jpg" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">
  <style>
    :root {
      --bg:#0f172a; --card:#1e293b; --text:#f1f5f9;
      --accent:#06b6d4; --accent2:#3b82f6; --danger:#ef4444;
      --radius:14px; font-family:'Inter', sans-serif;
    }
    body { margin:0; background:var(--bg); color:var(--text); }
    .site { max-width:1200px; margin:auto; padding:20px; }
    header { text-align:center; padding:20px 0; }
    header h1 { margin:0; font-size:28px; cursor:pointer;
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
    header p { margin:5px 0 0; color:#94a3b8; }

    .tabs { display:flex; justify-content:center; margin:20px 0; }
    .tab-btn { flex:1; padding:12px; cursor:pointer; font-weight:600; border:none;
      background:#1e293b; color:#cbd5e1; border-radius:var(--radius) var(--radius) 0 0;
      transition:all 0.3s; font-size:15px; }
    .tab-btn.active { background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#fff; }

    .panel { display:none; background:var(--card); padding:20px; border-radius:0 0 var(--radius) var(--radius); }
    .panel.active { display:block; }

    label { font-weight:600; margin-top:10px; display:block; }
    input, select { width:100%; padding:10px; border-radius:10px; border:none; margin-top:5px; }
    .btn { margin-top:15px; padding:10px 14px; border-radius:10px; border:none; font-weight:600; cursor:pointer; }
    .btn.primary { background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#fff; }
    .btn.danger { background:var(--danger); color:#fff; }
    .btn.whatsapp { background:#25D366; color:#fff; }

    #map { height:400px; border-radius:14px; overflow:hidden; margin:20px 0; }
    .meta { display:flex; justify-content:space-between; margin:8px 0; font-size:14px; color:#94a3b8; }
    #rideList li { background:#334155; padding:12px; border-radius:10px; margin:8px 0; cursor:pointer; transition:0.2s; }
    #rideList li:hover { background:#475569; }

    table { width:100%; border-collapse:collapse; margin-top:10px; font-size:14px; }
    th,td { padding:8px; border-bottom:1px solid #334155; }
    th { color:var(--accent2); }
    .toast { position:fixed; right:20px; bottom:20px; background:#1e293b; padding:12px 16px; border-radius:10px; display:none; }
    .toast.show { display:block; }

    footer { text-align:center; margin-top:30px; padding:20px; border-top:1px solid #334155; }
    footer .icons a { margin:0 10px; font-size:22px; color:#94a3b8; transition:0.3s; }
    footer .icons a:hover { color:var(--accent2); }
  </style>
</head>
<body>
  <div class="site">
    <header>
      <h1 onclick="window.location.href='index.html'">ShareRide ‚Äî Meerut</h1>
      <p>Smart ‚Ä¢ Safe ‚Ä¢ Shared Rides</p>
    </header>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('rider')">üöñ Rider</button>
      <button class="tab-btn" onclick="switchTab('driver')">üßë‚Äç‚úàÔ∏è Driver</button>
    </div>

    <!-- Rider Panel -->
    <div id="rider" class="panel active">
      <h2>Book a Ride</h2>
      <label>Pickup</label>
      <input id="pickup" type="text" placeholder="Enter pickup location" value="MIET Bagpat Road Meerut">
      <button class="btn whatsapp" onclick="shareDirectWhatsApp()">üì≤ Share Live Location</button>
      <label>Drop</label>
      <input id="drop" type="text" placeholder="Enter drop location">

      <div class="meta"><span>Fare:</span><strong>‚Çπ <span id="fare">-</span></strong></div>
      <div class="meta"><span>ETA:</span><strong><span id="eta">-</span> mins</strong></div>
      <button class="btn primary" onclick="findRide()">Find Ride</button>

      <div id="map">
        <iframe id="mapFrame"
          src="https://www.google.com/maps?q=MIET+Bagpat+Road+Meerut&output=embed"
          width="100%" height="100%" style="border:0;" allowfullscreen loading="lazy"></iframe>
      </div>

      <div id="rideOptions" style="display:none;">
        <h3>Available Rides</h3>
        <label>Sort By:</label>
        <select id="sortSelect" onchange="sortRides()">
          <option value="">-- Select --</option>
          <option value="fareLow">Fare: Low ‚Üí High</option>
          <option value="fareHigh">Fare: High ‚Üí Low</option>
          <option value="etaLow">ETA: Short ‚Üí Long</option>
        </select>
        <ul id="rideList" style="list-style:none; padding:0; margin:0;"></ul>
      </div>

      <div id="confirmSection" style="margin-top:15px; display:none;">
        <button class="btn primary" onclick="confirmBooking()">Confirm Book Now</button>
      </div>
    </div>

    <!-- Driver Panel -->
    <div id="driver" class="panel">
      <h2>Share Your Ride</h2>
      <label>Pickup</label>
      <input id="dPickup" type="text" placeholder="Enter pickup point">
      <label>Drop</label>
      <input id="dDrop" type="text" placeholder="Enter drop point">
      <label>Vehicle</label>
      <select id="dVehicle">
        <option value="Car">Car</option>
        <option value="Scooty">Scooty</option>
        <option value="Bike">Bike</option>
      </select>
      <label>Fare (‚Çπ)</label>
      <input id="dFare" type="number" placeholder="Enter fare">
      <label>ETA (mins)</label>
      <input id="dEta" type="number" placeholder="Enter ETA">
      <button class="btn primary" onclick="shareRide()">Share Ride</button>
    </div>

    <!-- Active Ride -->
    <div id="activeRide" class="panel" style="margin-top:20px; display:none;">
      <h2>Active Ride</h2>
      <div id="activeRideDetails"></div>
    </div>

    <!-- History -->
    <div id="history" class="panel" style="margin-top:20px; display:block;">
      <h2>Ride History</h2>
      <div>
        <button class="btn primary" onclick="downloadHistory()">‚¨áÔ∏è Download CSV</button>
        <button class="btn danger" onclick="clearHistory()">üóëÔ∏è Clear All</button>
      </div>
      <table>
        <thead>
          <tr><th>Pickup</th><th>Drop</th><th>Vehicle</th><th>Fare</th><th>ETA</th><th>Date-Time</th><th>Action</th></tr>
        </thead>
        <tbody id="historyBody"></tbody>
      </table>
    </div>

    <div id="toast" class="toast"></div>

    <!-- Footer -->
    <footer>
      <div class="icons">
        <a href="https://youtube.com/@sharemyride-s6w?si=AVczZ9NbBbMH940v" target="_blank" aria-label="YouTube"><i class="fab fa-youtube" style="font-size:18px;"></i></a>
        <a href="https://www.linkedin.com/in/share-my-ride-022281385?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" target="_blank"><i class="ri-linkedin-box-fill"></i></a>
        <a href="https://www.instagram.com/sharemyride_official?igsh=bWU2MDZlNngwMW1t" target="_blank"><i class="ri-instagram-fill"></i></a>
        <a href="https://x.com/ShareMyRid30840?t=6PNzJWIVOW738Dh0AdRTlA&s=08" target="_blank"><i class="ri-twitter-x-fill"></i></a>
        <a href="https://github.com" target="_blank"><i class="ri-github-fill"></i></a>
      </div>
      <p style="color:#94a3b8; font-size:13px;">¬© 2025 ShareRide ‚Äî Meerut</p>
    </footer>
  </div>

<script>
  const defaultPickup="";
  let selectedRide=null, activeRide=null, rideTimer=null, ridesData=[];

  function switchTab(tab){
    document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
    document.querySelectorAll(".panel").forEach(p=>p.classList.remove("active"));
    document.querySelector(`.tab-btn[onclick="switchTab('${tab}')"]`).classList.add("active");
    document.getElementById(tab).classList.add("active");
  }
  const toastEl=document.getElementById("toast");
  function showToast(msg){ toastEl.textContent=msg; toastEl.classList.add("show"); setTimeout(()=>toastEl.classList.remove("show"),3000); }

  // Rider: Find Ride
  function findRide(){
    let pickup=document.getElementById("pickup").value.trim()||defaultPickup;
    let drop=document.getElementById("drop").value.trim();
    if(!drop) return;
    if(drop.toLowerCase()==="miet"||drop.toLowerCase()==="miet meerut"){drop="MIET Bagpat Road Meerut";}
    if(pickup.toLowerCase()==="miet"||pickup.toLowerCase()==="miet meerut"){pickup="MIET Bagpat Road Meerut";}

    document.getElementById("mapFrame").src=`https://www.google.com/maps?q=${encodeURIComponent(pickup)}+to+${encodeURIComponent(drop)}&output=embed`;

    const distance=Math.floor(Math.random()*14)+2;
    const eta=distance*2;
    const fare=30+(distance*12);

    document.getElementById("fare").textContent=fare;
    document.getElementById("eta").textContent=eta;

    let rides=[
      {driver:"Ravi",vehicle:"Car",fare:fare,eta:eta},
      {driver:"Ankit",vehicle:"Bike",fare:fare-20,eta:eta+1}
    ];
    let driverRides=JSON.parse(localStorage.getItem("availableRides")||"[]");
    rides=[...rides,...driverRides]; ridesData=rides;
    renderRideList(rides);
    document.getElementById("rideOptions").style.display="block";
    document.getElementById("confirmSection").style.display="none";
  }

  function renderRideList(rides){
    const rideList=document.getElementById("rideList"); rideList.innerHTML="";
    rides.forEach(r=>{
      let li=document.createElement("li");
      li.innerHTML=`<strong>${r.driver}</strong> ‚Ä¢ ${r.vehicle||"-"}<br>Fare: ‚Çπ${r.fare} | ETA: ${r.eta} mins`;
      li.onclick=()=>selectRide(r); rideList.appendChild(li);
    });
  }

  function sortRides(){
    const val=document.getElementById("sortSelect").value;
    let sorted=[...ridesData];
    if(val==="fareLow") sorted.sort((a,b)=>a.fare-b.fare);
    else if(val==="fareHigh") sorted.sort((a,b)=>b.fare-a.fare);
    else if(val==="etaLow") sorted.sort((a,b)=>a.eta-b.eta);
    renderRideList(sorted);
  }

  function selectRide(r){ selectedRide=r; showToast(`Selected ${r.driver}'s ride ‚úÖ`); document.getElementById("confirmSection").style.display="block"; }

  function confirmBooking(){
    if(!selectedRide) return;
    const pickup=document.getElementById("pickup").value.trim()||defaultPickup;
    const drop=document.getElementById("drop").value.trim();
    activeRide={...selectedRide,pickup,drop,time:new Date().toLocaleString()};
    document.getElementById("activeRideDetails").innerHTML=`
      <p><strong>Driver:</strong> ${activeRide.driver}</p>
      <p><strong>Vehicle:</strong> ${activeRide.vehicle||"-"}</p>
      <p><strong>Fare:</strong> ‚Çπ${activeRide.fare}</p>
      <p><strong>ETA:</strong> ${activeRide.eta} mins</p>
      <p><strong>Pickup:</strong> ${activeRide.pickup}</p>
      <p><strong>Drop:</strong> ${activeRide.drop}</p>
      <p><strong>Start:</strong> ${activeRide.time}</p>`;
    document.getElementById("activeRide").style.display="block";
    document.getElementById("rideOptions").style.display="none";
    document.getElementById("confirmSection").style.display="none";
    showToast("üöñ Ride Confirmed");
    rideTimer=setTimeout(()=>{endRide(true)},activeRide.eta*60*1000);
    selectedRide=null;
  }

  function endRide(auto=false){
    if(!activeRide) return;
    saveRide(activeRide.pickup,activeRide.drop,activeRide.vehicle,`‚Çπ${activeRide.fare}`,activeRide.eta);
    showToast(auto?"‚úÖ Ride Auto-Completed":"‚úÖ Ride Completed");
    activeRide=null; clearTimeout(rideTimer);
    document.getElementById("activeRide").style.display="none";
  }

  // Driver: Share Ride
  function shareRide(){
    const pickup=document.getElementById("dPickup").value.trim(),
          drop=document.getElementById("dDrop").value.trim(),
          vehicle=document.getElementById("dVehicle").value,
          fare=parseInt(document.getElementById("dFare").value.trim()),
          eta=parseInt(document.getElementById("dEta").value.trim());
    if(!pickup||!drop||!fare||!eta){ showToast("‚ö† Fill all fields"); return; }
    const ride={driver:"Driver (You)",vehicle:vehicle,fare:fare,eta:eta,pickup,drop};
    let available=JSON.parse(localStorage.getItem("availableRides")||"[]");
    available.push(ride); localStorage.setItem("availableRides",JSON.stringify(available));
    showToast("üöñ Ride shared");
    document.getElementById("dPickup").value=document.getElementById("dDrop").value=document.getElementById("dFare").value=document.getElementById("dEta").value="";
  }

  // History
  function saveRide(pickup,drop,vehicle,fare,eta){
    const ride={pickup,drop,vehicle,fare,eta,time:new Date().toLocaleString()};
    let history=JSON.parse(localStorage.getItem("rideHistory")||"[]");
    history.unshift(ride); localStorage.setItem("rideHistory",JSON.stringify(history));
    renderHistory(history);
  }
  function deleteRide(i){ let h=JSON.parse(localStorage.getItem("rideHistory")||"[]"); h.splice(i,1); localStorage.setItem("rideHistory",JSON.stringify(h)); renderHistory(h); }
  function clearHistory(){ localStorage.removeItem("rideHistory"); renderHistory([]); }
  function downloadHistory(){
    let h=JSON.parse(localStorage.getItem("rideHistory")||"[]");
    if(!h.length){ showToast("‚ö† No history"); return; }
    let csv="Pickup,Drop,Vehicle,Fare,ETA,Date-Time\n";
    h.forEach(r=>{csv+=`${r.pickup},${r.drop},${r.vehicle},${r.fare},${r.eta} mins,${r.time}\n`;});
    const blob=new Blob([csv],{type:"text/csv"}); const link=document.createElement("a"); link.href=URL.createObjectURL(blob); link.download="ride_history.csv"; link.click();
  }
  function renderHistory(h){
    const body=document.getElementById("historyBody"); body.innerHTML="";
    h.forEach((r,i)=>{body.innerHTML+=`<tr><td>${r.pickup}</td><td>${r.drop}</td><td>${r.vehicle}</td><td>${r.fare}</td><td>${r.eta} mins</td><td>${r.time}</td><td><button class="btn danger" onclick="deleteRide(${i})">Delete</button></td></tr>`;});
  }
  function loadHistory(){ renderHistory(JSON.parse(localStorage.getItem("rideHistory")||"[]")); }
  window.onload=loadHistory;

  // Live location share
  function shareDirectWhatsApp(){
    if(navigator.geolocation){
      navigator.geolocation.getCurrentPosition(pos=>{
        const lat=pos.coords.latitude, lon=pos.coords.longitude;
        const mapsLink=`https://www.google.com/maps?q=${lat},${lon}`;
        document.getElementById("pickup").value=`My Location (${lat.toFixed(4)},${lon.toFixed(4)})`;
        document.getElementById("mapFrame").src=mapsLink+"&output=embed";
        const msg=`üìç My live location: ${mapsLink}`;
        window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`,"_blank");
      },()=>{ showToast("‚ö† Please allow location access in browser settings"); });
    } else { showToast("‚ö† Geolocation not supported"); }
  }
</script>
</body>
</html>
